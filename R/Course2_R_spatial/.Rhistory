## when working with raster data
## do NOT load both packages terra and raster at the same time,
## as this creates problems with the namespace
library(terra) ## the "new" {raster} package
library(rgdal)
library(rgeos)
library(rasterVis)
## working with vector data
library(sf) ## the "new" {sp} package
library(stars)
## visualization
library(ggplot2)
library(tmap)
library(viridis) ## nice colour palettes
library(patchwork) ## to combine plots
library(units) ## handle measurement data
library(here) ## for easy directory management
#install.packages("Rcpp", repos="https://rcppcore.github.io/drat")
here::here()    # tip: use the namespace here:: before calling to function here()
here::dr_here() # because here() alone interferes with the package `purrr` if that is loaded
root_wd <- here::here() # the root folder is automatically set
root_wd
## today, we start with Borneo
#dbor_wd     <- paste0(root_wd, "/", "data/data_borneo") #- the old way
dbor_wd     <- here("data","data_borneo") #- note the nested folder structure
#  maps_wd   <- here("data","data_borneo","geo_raster_current_asc")  ##  same as:
maps_wd   <- paste0(dbor_wd, "/geo_raster_current_asc") #- mind difference paste0() and paste()
vecs_wd   <- paste0(dbor_wd, "/geo_vector")
anim_wd   <-  paste(dbor_wd, "/animal_data", sep = '')   #- paste() needs a separator sign
## read the ascii file as raster format
ras_bio_asc_01 <- rast(x = paste0(maps_wd, "/bio_asc_01.asc")) ## `raster()` with {raster}
## or use here:
ras_bio_asc_01 <- rast(x = here("data", "data_borneo","geo_raster_current_asc", "bio_asc_01.asc"))
Bor_mat <- ras_bio_asc_01  ## easy copying of whole maps; mat stands for mean annual temp
# collapse 20*20 cells into 1 using function 'mean':
ras_bio_asc_01_agg <- aggregate(x = ras_bio_asc_01, fact = 20, fun = mean)
ras_bio_asc_01_agg
values(ras_bio_asc_01_agg )
## save the small aggregated file
terra::writeRaster(x = ras_bio_asc_01_agg,
filename = paste0(output_wd,"/bor_agg.asc"),
# or use here: here("output", "bor_agg.asc")
overwrite = TRUE,
NAflag = -9999)
#output_wd <- paste0(dirname(root_wd), "/", "output") #- the old way
output_wd <- here("output")
if (!dir.exists(output_wd)) {dir.create(output_wd)} #- create only if directory does NOT! exist
writeRaster(x = ras_bio_asc_01_agg,
filename = paste0(output_wd,"/bor_agg.asc"),
# or use here: here("output", "bor_agg.asc")
overwrite = TRUE,
NAflag = -9999)
## save the small aggregated file
terra::writeRaster(x = ras_bio_asc_01_agg,
filename = paste0(output_wd,"/bor_agg.asc"),
# or use here: here("output", "bor_agg.asc")
overwrite = TRUE,
NAflag = -9999)
ext(x = ras_bio_asc_01) ## `extent()` with {raster}
clip_extent <- ext(117.2, 117.45, 5.4, 5.5)
ras_bio_asc_01_cr <- crop(x = ras_bio_asc_01, y = clip_extent)
plot(ras_bio_asc_01_cr, col = viridis::inferno(10))
## save the small cropped file
terra::writeRaster(x = ras_bio_asc_01_cr,
filename = paste0(output_wd,"/bor_crop.asc"),
# or use here: here("output", "bor_crop.asc")
overwrite = TRUE,
NAflag = -9999)
## save the small cropped file
terra::writeRaster(x = ras_bio_asc_01_cr,
filename = paste0(output_wd,"/bor_crop.asc"),
# or use here: here("output", "bor_crop.asc")
overwrite = TRUE,
NAflag = -9999)
terra::writeRaster(x = ras_bio_asc_01_agg,
filename = paste0(output_wd,"/ras_bio_asc_01_agg.asc"),
# or use here: here("output", "bor_crop.asc")
overwrite = TRUE,
NAflag = -9999)
?writeRaster
## save the small cropped file
terra::writeRaster(x = ras_bio_asc_01_cr,
filename = paste0(output_wd,"/bor_crop.asc"),
# or use here: here("output", "bor_crop.asc")
datatype = "INT1U",
overwrite = TRUE,
NAflag = -9999)
ras_bio_asc_01
values(ras_bio_asc_01)
values(ras_bio_asc_01_agg)
## save the small cropped file
terra::writeRaster(x = ras_bio_asc_01_cr,
filename = paste0(output_wd,"/bor_crop.asc"),
# or use here: here("output", "bor_crop.asc")
datatype = "INT4U",
overwrite = TRUE,
NAflag = -9999)
?rast
